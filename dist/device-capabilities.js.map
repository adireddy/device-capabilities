{
"version":3,
"file":"device-capabilities.js",
"sourceRoot":"file:///",
"sources":["/projects/device-capabilities/src/Motion.hx","/projects/device-capabilities/src/Vibration.hx"],
"sourcesContent":["import js.html.DeviceMotionEvent;\nimport js.html.Window;\nimport js.Browser;\n\n@:keep @:expose class Motion {\n\n    var _window:Window;\n    var _x:Float;\n    var _y:Float;\n    var _z:Float;\n    var _time:Float;\n    var _threshold:Int;\n    var _interval:Int;\n    var _callback:Void -> Void;\n\n    public function new() {\n        _window = Browser.window;\n    }\n\n    public function shake(callback:Void -> Void, ?threshold:Int = 10, ?interval:Int = 1000) {\n        _reset();\n        _threshold = threshold;\n        _interval = interval;\n        _callback = callback;\n        _time = Date.now().getTime();\n        _window.addEventListener(\"devicemotion\", _onDeviceMotion);\n    }\n\n    public function stopShake() {\n        _window.removeEventListener(\"devicemotion\", _onDeviceMotion);\n        _callback = null;\n        _reset();\n    }\n\n    function _onDeviceMotion(evt:DeviceMotionEvent) {\n        if (_x == null || _y == null || _z == null) {\n            _x = evt.accelerationIncludingGravity.x;\n            _y = evt.accelerationIncludingGravity.y;\n            _z = evt.accelerationIncludingGravity.z;\n            return;\n        }\n\n        var diffX = Math.abs(_x - evt.accelerationIncludingGravity.x);\n        var diffY = Math.abs(_y - evt.accelerationIncludingGravity.x);\n        var diffZ = Math.abs(_z - evt.accelerationIncludingGravity.x);\n\n        if ((diffX > _threshold && diffY > _threshold) || (diffX > _threshold && diffZ > _threshold) || (diffY > _threshold && diffZ > _threshold)) {\n            if (Date.now().getTime() - _time > _interval) {\n                _callback();\n                _time = Date.now().getTime();\n            }\n        }\n\n        _x = evt.accelerationIncludingGravity.x;\n        _y = evt.accelerationIncludingGravity.y;\n        _z = evt.accelerationIncludingGravity.z;\n    }\n\n    inline function _reset() {\n        _x = null;\n        _y = null;\n        _z = null;\n        _time = null;\n    }\n}","import js.html.Navigator;\nimport js.Browser;\n\n// Chrome & Firefox only\n@:expose @:keep class Vibration {\n\n    public var isSupported:Bool;\n\n    var _navigator:Navigator;\n\n    public function new() {\n        _navigator = Browser.navigator;\n        isSupported = (Browser.window != null && _navigator.vibrate != null);\n    }\n\n    public function start(?duration:Int = 1000) {\n        if (isSupported) _navigator.vibrate(duration);\n    }\n\n    public function startPattern(pattern:Array<Int>) {\n        if (isSupported) _navigator.vibrate(pattern);\n    }\n\n    public function stop() {\n        if (isSupported) _navigator.vibrate(0);\n    }\n}"],
"names":[],
"mappings":";qBAeU,VACH;GAAU;;;OAGP;;;EACH;;;;EACA,CAAa;EACb,CAAY;EACZ,CAAY;EACZ,CAAQ;EACR,DAAyB,AAAgB;;WAGtC,AAAqB;EACxB,DAA4B,AAAgB;EAC5C,CAAY;EACZ;;;;;iBAGJ,HAAgD;EAC5C,AAAI,EAAM,AAAQ,AAAM,AAAQ,AAAM,HAAM;GACxC,AAAK;GACL,AAAK;GACL,AAAK;GACL;;EAGQ,DAAS,EAAK;EACd,DAAS,EAAK;EACd,DAAS,EAAK;EAE1B,AAAI,DAAC,EAAQ,CAAc,DAAQ,CAAe,AAAC,DAAQ,CAAc,DAAQ,CAAe,AAAC,DAAQ,CAAc,DAAQ,FAC3H;EAAI,CAAuB,AAAQ,FAAW;IAC1C;IACA,DAAQ;;;EAIhB,CAAK;EACL,CAAK;EACL,CAAK;;QAGF,GAAkB;EACrB,CAAK;EACL,CAAK;EACL,CAAK;EACL,CAAQ;;;wBCpDL,bAAe;CAClB,EAAa;CACb,EAAc,AAAC,CAAkB,AAAQ,AAAsB;;;OAG5D;;EACH,AAAI,DAAa,AAAmB;;cAGjC,IACH;EAAI,DAAa,AAAmB;;MAGjC,KACH;EAAI,DAAa,AAAmB;;;;;;;"
}